<% content_for :head do %>
  <%= stylesheet_link_tag "results" %>
<% end %>

<h1>Game Results</h1>

<table class="table table-bordered" style="background-color: #2e3236">
  <thead>
    <tr>
      <th>&nbsp;</th>
      <% @game.game_players.each do |game_player| %>
        <th><%= game_player.handle %></th>
      <% end %>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Units</td>
      <% @game.game_players.each do |game_player| %>
        <td><%= game_player.units %></td>
      <% end %>
    </tr>
    <tr>
      <td>Energy</td>
      <% @game.game_players.each do |game_player| %>
        <td><%= game_player.energy %></td>
      <% end %>
    </tr>
    <tr>
      <td>Space Stations</td>
      <% @game.game_players.each do |game_player| %>
        <td><%= game_player.space_stations %></td>
      <% end %>
    </tr>
    <tr>
      <td>Territories</td>
      <% @game.game_players.each do |game_player| %>
        <td><%= game_player.territory_count %></td>
      <% end %>
    </tr>
    <tr>
      <td>Continent Bonus</td>
      <% @game.game_players.each do |game_player| %>
        <td><%= game_player.continent_bonus %></td>
      <% end %>
    </tr>
    <tr>
      <td>Continents</td>
      <% @game.game_players.each do |game_player| %>
        <td>
          <ul class="continent-list">
            <% game_player.continents.each do |continent| %>
              <li><span class="continent" style="background-color: <%= continent.color %>"><%= continent.name %> (<%= continent.bonus %>)</span></li>
            <% end %>
          </ul>
        </td>
      <% end %>
    </tr>
    <tr>
      <td>Colony Influence</td>
      <% @game.game_players.each do |game_player| %>
        <td><%= game_player.colony_influence_bonus %></td>
      <% end %>
    </tr>
  </tbody>
  <tfoot>
    <tr>
      <td>Final Score</td>
      <% @game.game_players.each do |game_player| %>
        <td><%= game_player.final_score %></td>
      <% end %>
    </tr>
  </tfoot>
</table>

<h1>Territories</h1>
<div id="territories-chart" class="chart">
  <svg></svg>
</div>

<h1>Units</h1>
<div id="units-chart" class="chart">
  <svg></svg>
</div>

<h1>Energy</h1>
<div id="energy-chart" class="chart">
  <svg></svg>
</div>

<h1>Space Stations</h1>
<div id="space-stations-chart" class="chart">
  <svg></svg>
</div>

<h1>Continent Bonus</h1>
<div id="continent-bonus-chart" class="chart">
  <svg></svg>
</div>

<% content_for :tail do %>
  <%= javascript_include_tag "game_results" %>

  <script type="text/javascript">
    var territory_data       = <%= raw(@chart_data_formatter.territories) %>;
    var units_data           = <%= raw(@chart_data_formatter.units) %>;
    var energy_data          = <%= raw(@chart_data_formatter.energy) %>;
    var space_station_data   = <%= raw(@chart_data_formatter.space_stations) %>;
    var continent_bonus_data = <%= raw(@chart_data_formatter.continent_bonus) %>;
  </script>
<% end %>
